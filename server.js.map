{"version":3,"sources":["server.jsx"],"names":[],"mappings":"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","file":"server.js","sourcesContent":["/** @jsx h */\n\nimport { serve } from \"https://deno.land/std@0.121.0/http/server.ts\";\nimport { h, Helmet, renderSSR } from \"nano-jsx\";\nimport dayjsEsm from \"dayjs/esm\";\nimport dayjsPluginRelativeTime from \"dayjs/plugin/relativeTime\";\nimport { Package } from \"./lib/package.js\";\nimport { Home } from \"./lib/home.js\";\nimport { pageServingHeaders, renderMarkdownContent } from \"./utils.js\";\nimport { FEATURED_PACKAGES } from \"./lib/featured-packages-list.js\";\nimport { features, parseURL } from \"./lib/package-quality-check.js\";\n\nconst staticResources = {\n  \"/style.css\": { path: \"./style.css\", contentType: \"text/css; charset=utf-8\" },\n  \"/dom-main.js\": {\n    path: \"./lib/dom-main.js\",\n    contentType: \"application/javascript; charset=utf-8\",\n  },\n  \"/dom-main.js.map\": {\n    path: \"./lib/dom-main.js.map\",\n    contentType: \"application/javascript; charset=utf-8\",\n  },\n  \"/statehash.js\": {\n    path: \"./lib/statehash.js\",\n    contentType: \"application/javascript; charset=utf-8\",\n  },\n  \"/statehash.js.map\": {\n    path: \"./lib/statehash.js.map\",\n    contentType: \"application/javascript; charset=utf-8\",\n  },\n  \"/header.js\": {\n    path: \"./lib/header.js\",\n    contentType: \"application/javascript; charset=utf-8\",\n  },\n  \"/header.js.map\": {\n    path: \"./lib/header.js.map\",\n    contentType: \"application/javascript; charset=utf-8\",\n  },\n  \"/exports.js\": {\n    path: \"./lib/exports.js\",\n    contentType: \"application/javascript; charset=utf-8\",\n  },\n  \"/exports.js.map\": {\n    path: \"./lib/exports.js.map\",\n    contentType: \"application/javascript; charset=utf-8\",\n  },\n  \"/hero.js\": {\n    path: \"./lib/hero.js\",\n    contentType: \"application/javascript; charset=utf-8\",\n  },\n  \"/hero.js.map\": {\n    path: \"./lib/hero.js.map\",\n    contentType: \"application/javascript; charset=utf-8\",\n  },\n  \"/generate-statehash.js\": {\n    path: \"./lib/generate-statehash.js\",\n    contentType: \"application/javascript; charset=utf-8\",\n  },\n  \"/generate-statehash.js.map\": {\n    path: \"./lib/generate-statehash.js.map\",\n    contentType: \"application/javascript; charset=utf-8\",\n  },\n  \"/logo.js\": {\n    path: \"./lib/logo.js\",\n    contentType: \"application/javascript; charset=utf-8\",\n  },\n  \"/logo.js.map\": {\n    path: \"./lib/logo.js.map\",\n    contentType: \"application/javascript; charset=utf-8\",\n  },\n  \"/search.js\": {\n    path: \"./lib/search.js\",\n    contentType: \"application/javascript; charset=utf-8\",\n  },\n  \"/search.js.map\": {\n    path: \"./lib/search.js.map\",\n    contentType: \"application/javascript; charset=utf-8\",\n  },\n  \"/nav.js\": {\n    path: \"./lib/nav.js\",\n    contentType: \"application/javascript; charset=utf-8\",\n  },\n  \"/nav.js.map\": {\n    path: \"./lib/nav.js.map\",\n    contentType: \"application/javascript; charset=utf-8\",\n  },\n  \"/importmap-generator.js\": {\n    path: \"./lib/importmap-generator.js\",\n    contentType: \"application/javascript; charset=utf-8\",\n  },\n  \"/importmap-generator.js.map\": {\n    path: \"./lib/importmap-generator.js.map\",\n    contentType: \"application/javascript; charset=utf-8\",\n  },\n  \"/imports-hash-store.js\": {\n    path: \"./lib/imports-hash-store.js\",\n    contentType: \"application/javascript; charset=utf-8\",\n  },\n  \"/icon-add.svg\": {\n    path: \"./images/icon-add.svg\",\n    contentType: \"image/svg+xml; charset=utf-8\",\n  },\n  \"/icon-check.svg\": {\n    path: \"./images/icon-check.svg\",\n    contentType: \"image/svg+xml; charset=utf-8\",\n  },\n  \"/icon-typescript-logo.svg\": {\n    path: \"./images/icon-typescript-logo.svg\",\n    contentType: \"image/svg+xml; charset=utf-8\",\n  },\n  \"/favicon.ico\": {\n    path: \"./favicon.ico\",\n    contentType: \"image/vnd.microsoft.icon\",\n  },\n};\n\nasync function generateHTML(\n  { template, body, head, footer } = { template: \"./lib/shell.html\" },\n) {\n  const content = await Deno.readTextFile(template);\n  const [START, AFTER_HEADER_BEFORE_CONTENT, DOM_SCRIPT, END] = content\n    .split(/<!-- __[A-Z]*__ -->/i);\n  return [\n    START,\n    head.join(\"\\n\"),\n    AFTER_HEADER_BEFORE_CONTENT,\n    body,\n    DOM_SCRIPT,\n    footer.join(\"\\n\"),\n    END,\n  ].join(\"\\n\");\n}\n\n/**\n * @param {string} path\n * @returns {string}\n */\nfunction removeLeadingSlash(path) {\n  if (path.startsWith(\"/\")) {\n    return path.slice(1);\n  }\n  return path;\n}\n\n/**\n * @param {string} path\n * @returns {string}\n */\nfunction removeTrailingSlash(path) {\n  if (path.endsWith(\"/\")) {\n    return path.slice(0, -1);\n  }\n  return path;\n}\n\n/**\n * @param {string} path\n * @returns {string}\n */\nfunction removeSlashes(path) {\n  return removeTrailingSlash(removeLeadingSlash(path));\n}\n\nasync function requestHandler(request) {\n  try {\n    const { pathname, searchParams } = new URL(request.url);\n\n    const NPM_PROVIDER_URL = \"https://ga.jspm.io/npm:\";\n    const npmPackage = searchParams.get(\"q\");\n    if (npmPackage) {\n      const npmPackageProbe = await fetch(`${NPM_PROVIDER_URL}${npmPackage}`);\n      const npmPackageVersion = await npmPackageProbe.text();\n\n      if (npmPackageVersion) {\n        return new Response(npmPackage, {\n          status: 302,\n          headers: {\n            \"Location\": `/package/${npmPackage}@${npmPackageVersion}`,\n          },\n        });\n      }\n    }\n    const pathSegments = removeSlashes(pathname).split(\"/\");\n    const staticResource =\n      staticResources[`/${pathSegments[pathSegments.length - 1]}`];\n\n    if (staticResource) {\n      const response = await Deno.readFile(staticResource.path);\n\n      return new Response(response, {\n        headers: { \"content-type\": staticResource.contentType },\n      });\n    }\n\n    if (pathname === \"/\") {\n      const indexPage = renderSSR(\n        <Home packages={FEATURED_PACKAGES} />,\n      );\n      const { body, head, footer } = Helmet.SSR(indexPage);\n      const html = await generateHTML({\n        template: \"./lib/shell.html\",\n        body,\n        head,\n        footer,\n      });\n      return new Response(html, {\n        headers: pageServingHeaders,\n      });\n    }\n\n    const BASE_PATH = \"/package/\";\n    const maybeReadmeFiles = [\"README.md\", \"readme.md\"];\n\n    if (pathname.startsWith(BASE_PATH)) {\n      const [, packageName] = pathname.split(BASE_PATH);\n\n      if (packageName) {\n        const baseURL = `${NPM_PROVIDER_URL}${packageName}`;\n        const filesToFetch = [\"package.json\", ...maybeReadmeFiles];\n\n        const [jspmPackage, READMEFile, readmeFile] = await Promise.all(\n          filesToFetch.map((file) => fetch(`${baseURL}/${file}`)),\n        );\n          const packageJson = await jspmPackage.json();\n        const {\n          name,\n          description,\n          keywords,\n          version,\n          license,\n          files,\n          exports,\n          types,\n          type,\n          homepage,\n          repository,\n          bugs\n        } = packageJson;\n\n        const readmeFileContent = await [READMEFile, readmeFile]\n          .find(\n            (readmeFile) =>\n              readmeFile.status === 200 || readmeFile.status === 304,\n          )\n          .text();\n          // https://github.com/npm/registry/blob/master/docs/download-counts.md\n        const weeklyDownloadsResponse = await fetch(\n          `https://api.npmjs.org/downloads/point/last-week/${name}`,\n        );\n\n        const { downloads } = await weeklyDownloadsResponse.json();\n        // https://github.com/npm/registry\n        const packageMetaData = await fetch(\n          `https://registry.npmjs.org/${name}`,\n        );\n        const { maintainers, readme, time: { created: createdISO, modified } } = await packageMetaData.json();\n\n        dayjsEsm.extend(dayjsPluginRelativeTime);\n        const updated = dayjsEsm(modified).fromNow();\n        const created = dayjsEsm(createdISO).fromNow();\n        try {\n          // `readme` is preferred here but this content always refers to the latest version\n          // hence using it as fallback\n          const readmeHTML = renderMarkdownContent(readmeFileContent || readme);\n          // https://github.com/jspm/generator.jspm.io/blob/main/src/api.js#L137\n          const filteredExport = Object.keys(exports).filter((expt) =>\n            !expt.endsWith(\"!cjs\") && !expt.endsWith(\"/\") &&\n            expt.indexOf(\"*\") === -1\n          ).sort();\n\n          const links = {\n            homepage,\n            repository: parseURL(repository),\n            issues: parseURL(bugs)\n          }\n\n          const app = renderSSR(\n            <Package\n              name={name}\n              description={description}\n              version={version}\n              homepage={homepage}\n              license={license}\n              files={files}\n              exports={filteredExport}\n              readme={readmeHTML}\n              keywords={keywords}\n              downloads={downloads}\n              created={created}\n              updated={updated}\n              type={type}\n              types={types}\n              features={features(packageJson)}\n              links={links}\n              maintainers={maintainers}\n            />,\n          );\n          const { body, head, footer } = Helmet.SSR(app);\n          /* Hack to SSR readme :! */\n          const html = await generateHTML({\n            template: \"./lib/shell.html\",\n            body,\n            head,\n            footer,\n          });\n\n          return new Response(html, {\n            headers: pageServingHeaders,\n          });\n        } catch (e) {\n          console.error(`Failed in generating package-page ${name}@${version}`);\n          console.error(e);\n          return new Response(\"500\", { status: 500 });\n        }\n      }\n    }\n\n    return new Response(\"404\", { status: 404 });\n  } catch (error) {\n    return new Response(error.message || error.toString(), { status: 500 });\n  }\n}\n\nif (import.meta?.main) {\n  const timestamp = Date.now();\n  const humanReadableDateTime = new Intl.DateTimeFormat(\"default\", {\n    dateStyle: \"full\",\n    timeStyle: \"long\",\n  }).format(timestamp);\n\n  console.log(\"Current Date: \", humanReadableDateTime);\n  console.info(`Server Listening on http://localhost:8000`);\n\n  serve(requestHandler);\n}\n"]}